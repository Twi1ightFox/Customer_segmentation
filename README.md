# Customer_segmentation

**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.


### Оглавление

[Описание проекта](#описание-проекта) 

[Этапы проекта](#этапы-проекта)  

[Структура проекта](#структура-проекта)  

[Используемые библиотеки](#используемые-библиотеки) 

[Итоги](#итоги) 

[Установка и использование](#установка-и-использование)  

### ***Описание проекта***

Необходимо построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

В The UCI Machine Learning Repository создали набор данных, содержащий фактические транзакции за 2010 и 2011 годы. Именно эти данные будут использованы в проекте.
Датасет содержит все транзакции, произошедшие за период с 01/12/2010 по 09/12/2011, для базирующейся в Великобритании компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками.

:arrow_up:[к оглавлению](#оглавление)

### Этапы проекта

* Первичная обработка данных:
  
*Очистка данных от пропусков и выбросов для обеспечения их качества.*

* Разведывательный анализ данных (EDA):
  
*Исследование данных для выявления закономерностей и формулирования гипотез.*

* RFM-сегментация клиентов:
  
*Суть RFM-анализа состоит в том, что мы разделяем всех клиентов на группы в зависимости от того, как давно они сделали последнюю покупку, как часто покупали и насколько большой была сумма их заказов.*

* Решение задач обучения без учителя: кластеризация и снижение размерности:
  
*Использование методов понижения размерности (PCA и t-SNE) и методов кластеризации (KMeans, EM, AgglomerativeClustering)*

* Построение полярных диаграмм:
  
*Распределение клиентов по различным сегментам в зависимости от количества купленных товаров, давности и суммы заказаов.

* Решение задач обучения с учителем: классификация, а также подбор лучших параметров.
  
*GradientBoostingClassifier, RandomForestClassifier. Подбор параметров с помощью GridSearchCV*


   
:arrow_up:[к оглавлению](#оглавление)

### ***Структура проекта***

- [Project_6.ipynb](https://github.com/Twi1ightFox/Customer_segmentation/blob/master/Project_6.ipynb): Jupyter ноутбук.
- [README.md](https://github.com/Twi1ightFox/Customer_segmentation/blob/master/README.md): Описание проекта.
- [graphs](https://github.com/Twi1ightFox/Customer_segmentation/tree/master/graphs): Папка с графиками.
- [requirements.txt](https://github.com/Twi1ightFox/Customer_segmentation/blob/master/requirements.txt): Зависимости.

:arrow_up:[к оглавлению](#оглавление)

### Используемые библиотеки

Для работы с проектом потребуется установить следующие библиотеки:

- numpy     
- pandas         
- seaborn       
- matplotlib.pyplot  
- sklearn
- optuna
- другие библиотеки (файл requireents.txt)
  
:arrow_up:[к оглавлению](#оглавление)

### Итоги:
После обработки и подготовки данных, была произведена оценка потребительской ценности.

Для этого для каждого потребителя были расчитаны 3 показателя:

* Recency (Давность) — давность последней покупки клиента;
* Frequency (Частота) — общее количество покупок клиента;
* Monetary Value (Денежная ценность) — сколько денег потратил клиент.

Благодаря этому мы можем разделить всех клиентов на группы в зависимости от того, как давно они сделали последнюю покупку, как часто покупали и насколько большой была сумма их заказов.

Далее необходимо было выбрать метод пониженя размерности для дальнейшей кластеризации.

В ходе проекта были рассмотрены 3 - PCA и t-SNE.

Был выбран метод t-SNE, а в качестве модели кластеризации KMeans.

Проблема t-SNE заключается в том, что алгоритм непараметрический. Это значит, что он, в отличие от таких алгоритмов, как PCA и SVD, не создаёт явной функции отображения. Проще говоря, алгоритм трансформирует пространство признаков для обучающей выборки, но не запоминает, каким образом это делает. Это значит, что, передав в алгоритм новые объекты для сжатия пространства, мы получим абсолютно новое представление пространства, не имеющее отношения к тому, что мы построили для обучающей выборки. То есть произойдёт искажение, что может привести к неверным результатам кластеризации.

Именно поэтому у класса TSNE из библиотеки sklearn нет такого метода, как transform(), у него есть только метод fit_transform() — заново обучить алгоритм t-SNE и произвести трансформацию.

Сведём задачу кластеризации к задаче классификации. Действительно, у нас теперь есть истинные метки кластеров, а есть клиенты, которые описываются RFM-характеристиками. Обучим модель, которая на основе RFM-характеристик будет предсказывать клиентский сегмент.

**RandomForestClassifier**:
 accuracy = 0.985
 
 **GradientBoostingClassifier**:
  accuracy = 0.991

  #### **Полярная диаграмма на основе средних RFM-характеристик**
  ![Полярная диаграмма на основе средних RFM-характеристик](https://github.com/Twi1ightFox/Customer_segmentation/blob/master/graphs/newplot.png)
  
* Кластер 0 соответствует «лояльным» клиентам, которые приносят наибольший доход, совершают покупки чаще всего, а давность их последней покупки наименьшая.
* Кластер 2 соответствует «перспективным» клиентам, которые являются активными покупателями, но покупают не так часто и не так много, как лояльные клиенты.
* Кластер 4 соответствует «подвисшим» клиентам, которые относительно недавно сделали несколько заказов на небольшие суммы. Потенциально эти клиенты могут быть переведены в кластер «перспективных».
* Кластер 1 соответствует клиентам «в зоне риска», которые несколько раз покупали товары на небольшие суммы, однако их последняя покупка была совершена более пяти месяцев назад.
* Кластер 3 соответствует клиентам-«новичкам», которые относительно недавно сделали один заказ на небольшую сумму.
* Кластер 5 соответствует «спящим» или «почти потерянным» клиентам, которые сделали один заказ на маленькую сумму более пяти месяцев назад и больше не возвращались.
* Кластер 6 соответствует «потерянным» клиентам, которые купили меньше всего товара, и их последняя покупка была совершена около года назад.
:arrow_up:[к оглавлению](#оглавление)

### Установка и использование

1. Клонируйте репозиторий:
   git clone [https://github.com/Twi1ightFox/Customer_segmentation/tree.git](https://github.com/Twi1ightFox/Customer_segmentation/tree)
   
2. Загрузите необходимые файлы:
   
   (Данные для проекта)[https://drive.google.com/uc?id=1Axlknf1Rd6T6UFRzWWZA_gBbfN2g9r3v]
   
3. Запустить Jupyter notebook для просмотра и запуска анализа.

:arrow_up:[к оглавлению](#оглавление)
